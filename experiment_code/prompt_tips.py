# -*- coding: utf-8 -*-
"""prompt_tips.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZV8cIkNUgjzn3uaLzyoVdVNGpgqVPWEL
"""

!pip install openai

from openai import OpenAI
from pprint import pprint

openai_api_key = "XXX"

client = OpenAI(api_key=openai_api_key)

"""## Place instructions at the beginning of the prompt using ### (separator 1) or ''' (separator 2) to separate them from the context."""

def generate_patient_info(prompt):
    response = client.chat.completions.create(
        model="gpt-3.5-turbo",
        messages=[
          {"role": "system", "content": "You are a helpful assistant to generate the patient's message."},
          {"role": "user", "content": prompt}
        ]
        )
    message_content = response.choices[0].message.content
    return message_content

# The range of patient details
patient_detail = """
Age: between 20 and 80 years old
Gender: male or female or other
Symptoms: common dental issues, including tooth pain, gum bleeding, tooth decay, bad breath, sensitive teeth,
swollen gums, tooth discoloration, mouth sores, loose teeth, receding gums etc
Allergy history: allergies to specific medications, foods, or other substances (please clarify the exact items)
Social habits: whether the patient smokes or drinks alcohol
Lifestyle habits: whether the patient likes to eat sweets, tooth brushing habits, tooth brushing method
"""

prompt1 = f"""
Please generate information for a patient visiting the dentist in JSON format. The patient's information should include the following:
{patient_detail}
For Age, randomly select a value within a given age range, not just the middle value.
For Symptoms, include one or two symptoms, and briefly describe the symptoms without jargon.
For Allergy history, it can be either "no allergy" or one specific allergy.
Only generate the information within patient_detail, without replying to any other irrelevant information.
"""
print("Without separator:")
patient_info1 = generate_patient_info(prompt1)
pprint(patient_info1, indent=2, width=80)

# Prompt with ### separator
prompt2 = f"""
Please generate information for a patient visiting the dentist in JSON format. The patient's information should include the following:
###
{patient_detail}
###
For Age, randomly select a value within a given age range, not just the middle value.
For Symptoms, include one or two symptoms, and briefly describe the symptoms without jargon.
For Allergy history, it can be either "no allergy" or one specific allergy.
Only generate the information within patient_detail, without replying to any other irrelevant information.
"""
print("\nWith separator ###:")
patient_info2 = generate_patient_info(prompt2)
print(patient_info2)

# Prompt with """ separator
prompt3 = f'''
Please generate information for a patient visiting the dentist in JSON format. The patient's information should include the following:
"""
{patient_detail}
"""
For Age, randomly select a value within a given age range, not just the middle value.
For Symptoms, include one or two symptoms, and briefly describe the symptoms without jargon.
For Allergy history, it can be either "no allergy" or one specific allergy.
Only generate the information within patient_detail, without replying to any other irrelevant information.
'''

print('\nWith separator """:')
patient_info3 = generate_patient_info(prompt3)
print(patient_info3)

"""# Specify the desired output format through examples"""

prompt_output = f"""
Please generate information for a patient visiting the dentist. The patient's information should include the following:
###
{patient_detail}
###

The output should be in the following format:

Age: -||-
Gender: -||-
Symptoms: -||-
Allergy history: -||-
Social habits: -||-
Lifestyle habits: -||-

For Age, randomly select a value within a given age range, not just the middle value.
For Symptoms, include one or two symptoms, and briefly describe the symptoms without jargon.
For Allergy history, it can be either "no allergy" or one specific allergy.
Only generate the information in the specified plain text format. Don't reply in JSON or any other structured format.

"""
print("\nWith desired output format:")
patient_info_with_output = generate_patient_info(prompt_output)
print(patient_info_with_output)

"""# Rather than only stating what not to do, clearly specify what should be done instead."""

prompt_not_to_do = f"""
You are the patient who is going to see a dentist.
Only generate the answer on the role of patient and based on the dentist's question. Don't generate more than three sentences. Don't repeat the same sentence twice.
When the dentist greets you, you are not expected to respond with medical information.
The generated dialogue should not be in awkward transitions.
It should generate only several sentences and wait for the dentist to respond.
The patient's symptoms is:
"Age: 45 years old
Gender: Female
Symptoms: Experiencing bad breath and swollen gums
Allergy history: No allergy
Social habits: Non-smoker, occasional alcohol drinker
Lifestyle habits: Enjoys eating sweets, brushes teeth twice a day using a soft-bristled toothbrush"

The dentist's question is: "Good, how about you? What bring you here today?"
Remember to keep your response relevant to the dentist's question about your health and lifestyle. Avoid providing unrelated details.

"""
print("\nThe answer is:")
answer_by_not_to_do = generate_patient_info(prompt_not_to_do)
print(answer_by_not_to_do)

prompt_to_do = f"""
You are the patient who is going to see a dentist.
Only generate the answer on the role of patient and based on the dentist's question. It should be two or three sentences.
When the dentist greets you, you should only respond in greeting.
The generated dialogue should be coherent and natural, with seamless transitions.
It should generate only several sentences and wait for the dentist to respond.
The patient's symptoms is:
"Age: 45 years old
Gender: Female
Symptoms: Experiencing bad breath and swollen gums
Allergy history: No allergy
Social habits: Non-smoker, occasional alcohol drinker
Lifestyle habits: Enjoys eating sweets, brushes teeth twice a day using a soft-bristled toothbrush"

The dentist's question is: "Good, how about you? What bring you here today?"
Remember to keep your response relevant to the dentist's question about your health and lifestyle.

"""
print("\nThe answer is:")
answer_by_what_to_do = generate_patient_info(prompt_to_do)
print(answer_by_what_to_do)

"""# Begin with zero-shot prompting, followed by few-shot prompting, and if neither approach is effective, proceed to fine-tuning"""

prompt_zero_shot = f"""
You are the patient who is going to see a dentist.
When the dentist greets you, you should only respond in greeting.
The generated dialogue should be coherent and natural, with seamless transitions.
It should generate only several sentences and wait for the dentist to respond.
The patient's symptoms is:
"Age: 45 years old
Gender: Female
Symptoms: Experiencing bad breath and swollen gums
Allergy history: No allergy
Social habits: Non-smoker, occasional alcohol drinker
Lifestyle habits: Enjoys eating sweets, brushes teeth twice a day using a soft-bristled toothbrush"

The dentist's question is: "Good, how about you? What bring you here today?"
Only generate the answer on the role of patient and based on the dentist's question. It should be two or three sentences.
"""
print("\nThe answer is:")
answer_by_prompt_zero_shot = generate_patient_info(prompt_zero_shot)
print(answer_by_prompt_zero_shot)

prompt_few_shot = f"""
You are the patient who is going to see a dentist.
When the dentist greets you, you should only respond in greeting.
Only generate the answer on the role of patient and based on the dentist's question. It should be two or three sentences.
Example:
Dentist: "Good, how about you? "
Patient: "Hello, I'm doing well, thank you."
Dentist: "What brings you here today? "
Patient: "I've been noticing some bad breath and swollen gums lately."

The generated dialogue should be coherent and natural, with seamless transitions.
It should generate only several sentences and wait for the dentist to respond.
The patient's symptoms is:
"Age: 45 years old
Gender: Female
Symptoms: Experiencing bad breath and swollen gums
Allergy history: No allergy
Social habits: Non-smoker, occasional alcohol drinker
Lifestyle habits: Enjoys eating sweets, brushes teeth twice a day using a soft-bristled toothbrush"

The dentist's question is: "Good, what's your day today?"

"""
print("\nThe answer is:")
answer_by_prompt_few_shot = generate_patient_info(prompt_few_shot)
print(answer_by_prompt_few_shot)